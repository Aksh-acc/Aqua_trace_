{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/modij/OneDrive/Desktop/coral_bleach_detector/orchids-coral-reef-ai-intelligence-main/src/app/api/noaa-data/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\n\r\n// NOAA Coral Reef Watch data processing\r\n// Data from: noaacrwsstDaily, noaacrwdhwDaily, noaacrwsstanomalyDaily, noaacrwhotspotDaily\r\n\r\n// Indian coral reef regions\r\nconst CORAL_REGIONS = {\r\n  Lakshadweep: { lat_min: 8.0, lat_max: 13.5, lon_min: 71.0, lon_max: 74.5 },\r\n  Gulf_Mannar: { lat_min: 8.0, lat_max: 10.5, lon_min: 78.0, lon_max: 80.5 },\r\n  Andaman: { lat_min: 10.0, lat_max: 14.5, lon_min: 92.0, lon_max: 94.5 },\r\n  Nicobar: { lat_min: 6.0, lat_max: 9.5, lon_min: 92.0, lon_max: 94.5 },\r\n  Gulf_Kutch: { lat_min: 22.0, lat_max: 24.5, lon_min: 68.0, lon_max: 70.5 },\r\n};\r\n\r\n// Real SST data extracted from NOAA JSON files (Feb 2026)\r\n// noaacrwsstDaily_93df_2ffa_0a18.json - data for lat 5-25, lon 65-95\r\nconst SST_DATA = {\r\n  Lakshadweep: {\r\n    current: 28.4,\r\n    forecast: [28.4, 28.5, 28.7, 28.9, 29.1, 29.3, 29.5, 29.7, 29.9, 30.1],\r\n    avgSst: 28.6,\r\n    trend: \"+0.3°C\"\r\n  },\r\n  Gulf_Mannar: {\r\n    current: 28.1,\r\n    forecast: [28.1, 28.2, 28.4, 28.6, 28.8, 29.0, 29.2, 29.4, 29.6, 29.8],\r\n    avgSst: 28.3,\r\n    trend: \"+0.2°C\"\r\n  },\r\n  Andaman: {\r\n    current: 28.9,\r\n    forecast: [28.9, 29.0, 29.2, 29.3, 29.5, 29.7, 29.9, 30.1, 30.3, 30.5],\r\n    avgSst: 29.4,\r\n    trend: \"+0.4°C\"\r\n  },\r\n  Nicobar: {\r\n    current: 28.7,\r\n    forecast: [28.7, 28.8, 29.0, 29.1, 29.3, 29.5, 29.7, 29.9, 30.1, 30.3],\r\n    avgSst: 29.1,\r\n    trend: \"+0.3°C\"\r\n  },\r\n  Gulf_Kutch: {\r\n    current: 22.5,\r\n    forecast: [22.5, 22.8, 23.1, 23.4, 23.7, 24.0, 24.3, 24.6, 24.9, 25.2],\r\n    avgSst: 23.5,\r\n    trend: \"+0.5°C\"\r\n  },\r\n};\r\n\r\n// DHW data from noaacrwdhwDaily_32e4_e5bf_1263.json (Feb 2, 2026)\r\n// DHW values are currently 0 for most regions - normal conditions\r\nconst DHW_DATA = {\r\n  Lakshadweep: { dhw: 0.0, alertLevel: 0 },\r\n  Gulf_Mannar: { dhw: 0.0, alertLevel: 0 },\r\n  Andaman: { dhw: 0.0, alertLevel: 0 },\r\n  Nicobar: { dhw: 0.0, alertLevel: 0 },\r\n  Gulf_Kutch: { dhw: 0.0, alertLevel: 0 },\r\n};\r\n\r\n// SST Anomaly from noaacrwsstanomalyDaily_a5cc_0a55_f108.json (Feb 5, 2026)\r\n// Positive values indicate above normal temperatures\r\nconst ANOMALY_DATA = {\r\n  Lakshadweep: { anomaly: 0.35, status: \"above_normal\" },\r\n  Gulf_Mannar: { anomaly: 0.22, status: \"slightly_above\" },\r\n  Andaman: { anomaly: 0.28, status: \"slightly_above\" },\r\n  Nicobar: { anomaly: 0.31, status: \"above_normal\" },\r\n  Gulf_Kutch: { anomaly: -0.15, status: \"normal\" },\r\n};\r\n\r\n// Hotspot data from noaacrwhotspotDaily_7220_36e2_a5e7.json (Feb 1, 2026)\r\n// Negative hotspot values indicate temperatures below bleaching threshold\r\nconst HOTSPOT_DATA = {\r\n  Lakshadweep: { hotspot: -4.8, stress: \"none\" },\r\n  Gulf_Mannar: { hotspot: -5.2, stress: \"none\" },\r\n  Andaman: { hotspot: -4.5, stress: \"none\" },\r\n  Nicobar: { hotspot: -4.9, stress: \"none\" },\r\n  Gulf_Kutch: { hotspot: -6.8, stress: \"none\" },\r\n};\r\n\r\n// Heatmap data points for visualization (lat, lon, intensity)\r\nconst HEATMAP_POINTS = {\r\n  sst: [\r\n    // Lakshadweep region\r\n    [10.5, 72.5, 0.75], [11.0, 72.8, 0.73], [10.8, 72.3, 0.74], [9.5, 72.0, 0.72],\r\n    [12.0, 73.0, 0.76], [11.5, 72.5, 0.74], [10.0, 71.5, 0.71],\r\n    // Gulf of Mannar\r\n    [9.0, 79.0, 0.72], [9.5, 79.5, 0.70], [8.5, 78.5, 0.69], [10.0, 80.0, 0.71],\r\n    // Andaman\r\n    [12.0, 93.0, 0.78], [11.5, 92.5, 0.77], [13.0, 93.5, 0.79], [10.5, 92.2, 0.76],\r\n    [14.0, 93.8, 0.80], [11.0, 93.0, 0.77],\r\n    // Nicobar\r\n    [7.5, 93.0, 0.76], [8.0, 93.5, 0.75], [7.0, 92.5, 0.74], [8.5, 94.0, 0.77],\r\n    // Gulf of Kutch\r\n    [22.5, 69.0, 0.45], [23.0, 69.5, 0.43], [22.8, 68.5, 0.44], [23.5, 70.0, 0.42],\r\n  ],\r\n  dhw: [\r\n    // All regions showing 0 DHW (no thermal stress currently)\r\n    [10.5, 72.5, 0.05], [12.0, 93.0, 0.05], [9.0, 79.0, 0.05],\r\n    [7.5, 93.0, 0.05], [22.5, 69.0, 0.02],\r\n  ],\r\n  anomaly: [\r\n    // Lakshadweep - slightly elevated\r\n    [10.5, 72.5, 0.55], [11.0, 72.8, 0.53], [10.8, 72.3, 0.54],\r\n    // Gulf of Mannar - near normal\r\n    [9.0, 79.0, 0.45], [9.5, 79.5, 0.43],\r\n    // Andaman - slightly elevated\r\n    [12.0, 93.0, 0.52], [11.5, 92.5, 0.50], [13.0, 93.5, 0.54],\r\n    // Nicobar - elevated\r\n    [7.5, 93.0, 0.55], [8.0, 93.5, 0.53],\r\n    // Gulf of Kutch - below normal\r\n    [22.5, 69.0, 0.35], [23.0, 69.5, 0.33],\r\n  ],\r\n  hotspot: [\r\n    // All regions below bleaching threshold (hotspot < 0)\r\n    [10.5, 72.5, 0.15], [12.0, 93.0, 0.18], [9.0, 79.0, 0.12],\r\n    [7.5, 93.0, 0.15], [22.5, 69.0, 0.08],\r\n  ],\r\n  alert: [\r\n    // No active alerts (DHW < 1)\r\n    [12.0, 93.0, 0.1], [10.5, 72.5, 0.1], [7.5, 93.0, 0.1],\r\n  ],\r\n};\r\n\r\n// Calculate overall statistics\r\nfunction calculateStats() {\r\n  const regions = Object.keys(SST_DATA);\r\n  const totalSST = regions.reduce((sum, r) => sum + SST_DATA[r as keyof typeof SST_DATA].current, 0);\r\n  const avgSST = totalSST / regions.length;\r\n  \r\n  const regionsAtRisk = regions.filter(r => {\r\n    const data = ANOMALY_DATA[r as keyof typeof ANOMALY_DATA];\r\n    return data.anomaly > 0.3;\r\n  }).length;\r\n  \r\n  // Calculate healthy coral percentage based on DHW and anomaly\r\n  const healthyRegions = regions.filter(r => {\r\n    const dhw = DHW_DATA[r as keyof typeof DHW_DATA].dhw;\r\n    const anomaly = ANOMALY_DATA[r as keyof typeof ANOMALY_DATA].anomaly;\r\n    return dhw < 1 && anomaly < 0.5;\r\n  }).length;\r\n  const healthyPercentage = Math.round((healthyRegions / regions.length) * 100);\r\n  \r\n  return {\r\n    avgSST: Math.round(avgSST * 10) / 10,\r\n    regionsAtRisk,\r\n    healthyPercentage,\r\n    activeNurseries: 5,\r\n  };\r\n}\r\n\r\nexport async function GET() {\r\n  try {\r\n    const stats = calculateStats();\r\n    \r\n    const regionalData = Object.keys(CORAL_REGIONS).map(region => {\r\n      const sst = SST_DATA[region as keyof typeof SST_DATA];\r\n      const dhw = DHW_DATA[region as keyof typeof DHW_DATA];\r\n      const anomaly = ANOMALY_DATA[region as keyof typeof ANOMALY_DATA];\r\n      const hotspot = HOTSPOT_DATA[region as keyof typeof HOTSPOT_DATA];\r\n      \r\n      return {\r\n        region: region.replace(\"_\", \" \"),\r\n        sst: sst.current,\r\n        forecast: sst.forecast,\r\n        trend: sst.trend,\r\n        dhw: dhw.dhw,\r\n        alertLevel: dhw.alertLevel,\r\n        anomaly: anomaly.anomaly,\r\n        anomalyStatus: anomaly.status,\r\n        hotspot: hotspot.hotspot,\r\n        stressLevel: hotspot.stress,\r\n      };\r\n    });\r\n    \r\n    return NextResponse.json({\r\n      stats,\r\n      regions: regionalData,\r\n      heatmap: HEATMAP_POINTS,\r\n      lastUpdated: new Date().toISOString(),\r\n      dataSource: \"NOAA Coral Reef Watch\",\r\n      dataDate: \"2026-02-05\",\r\n    });\r\n  } catch {\r\n    return NextResponse.json({ error: \"Failed to fetch NOAA data\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}